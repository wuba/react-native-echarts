import{GraphQLError as e,print as r,parse as t,Kind as a}from"@0no-co/graphql.web";import{filter as n,fromAsyncIterable as o}from"wonka";var s=r=>r&&r.message&&(r.extensions||"GraphQLError"===r.name)?r:"object"==typeof r&&r.message?new e(r.message,r.nodes,r.source,r.positions,r.path,r,r.extensions||{}):new e(r);class i extends Error{constructor(e){var r=(e.graphQLErrors||[]).map(s),t=((e,r)=>{var t="";if(e)return`[Network] ${e.message}`;if(r)for(var a of r)t&&(t+="\n"),t+=`[GraphQL] ${a.message}`;return t})(e.networkError,r);super(t),this.name="CombinedError",this.message=t,this.graphQLErrors=r,this.networkError=e.networkError,this.response=e.response}toString(){return this.message}}var f=(e,r)=>{for(var t=0|(r||5381),a=0,n=0|e.length;a<n;a++)t=(t<<5)+t+e.charCodeAt(a);return t},l=new Set,c=new WeakMap,d=e=>{if(null===e||l.has(e))return"null";if("object"!=typeof e)return JSON.stringify(e)||"";if(e.toJSON)return d(e.toJSON());if(Array.isArray(e)){var r="[";for(var t of e)r.length>1&&(r+=","),r+=d(t)||"null";return r+"]"}if(v!==y&&e instanceof v||h!==y&&e instanceof h)return"null";var a=Object.keys(e).sort();if(!a.length&&e.constructor&&e.constructor!==Object){var n=c.get(e)||Math.random().toString(36).slice(2);return c.set(e,n),d({__key:n})}l.add(e);var o="{";for(var s of a){var i=d(e[s]);i&&(o.length>1&&(o+=","),o+=d(s)+":"+i)}return l.delete(e),o+"}"},p=(e,r,t)=>{if(null==t||"object"!=typeof t||t.toJSON||l.has(t));else if(Array.isArray(t))for(var a=0,n=t.length;a<n;a++)p(e,`${r}.${a}`,t[a]);else if(t instanceof v||t instanceof h)e.set(r,t);else for(var o of(l.add(t),Object.keys(t)))p(e,`${r}.${o}`,t[o])},u=e=>(l.clear(),d(e));class y{}var v="undefined"!=typeof File?File:y,h="undefined"!=typeof Blob?Blob:y,x=/("{3}[\s\S]*"{3}|"(?:\\.|[^"])*")/g,g=/(?:#[^\n\r]+)?(?:[\r\n]+|$)/g,m=(e,r)=>r%2==0?e.replace(g,"\n"):e,w=e=>e.split(x).map(m).join("").trim(),b=new Map,N=new Map,O=e=>{var t;return"string"==typeof e?t=w(e):e.loc&&N.get(e.__key)===e?t=e.loc.source.body:(t=b.get(e)||w(r(e)),b.set(e,t)),"string"==typeof e||e.loc||(e.loc={start:0,end:t.length,source:{body:t,name:"gql",locationOffset:{line:1,column:1}}}),t},k=e=>{var r=f(O(e));if(e.definitions){var t=j(e);t&&(r=f(`\n# ${t}`,r))}return r},E=e=>{var r,a;return"string"==typeof e?(r=k(e),a=N.get(r)||t(e,{noLocation:!0})):(r=e.__key||k(e),a=N.get(r)||e),a.loc||O(a),a.__key=r,N.set(r,a),a},A=(e,r,t)=>{var a=r||{},n=E(e),o=u(a),s=n.__key;return"{}"!==o&&(s=f(o,s)),{key:s,query:n,variables:a,extensions:t}},j=e=>{for(var r of e.definitions)if(r.kind===a.OPERATION_DEFINITION)return r.name?r.name.value:void 0},S=e=>{for(var r of e.definitions)if(r.kind===a.OPERATION_DEFINITION)return r.operation},_=(e,r,t)=>{if(!("data"in r)&&!("errors"in r))throw new Error("No Content");var a="subscription"===e.kind;return{operation:e,data:r.data,error:Array.isArray(r.errors)?new i({graphQLErrors:r.errors,response:t}):void 0,extensions:r.extensions?{...r.extensions}:void 0,hasNext:null==r.hasNext?a:r.hasNext,stale:!1}},T=(e,r)=>{if("object"==typeof e&&null!=e&&(!e.constructor||e.constructor===Object||Array.isArray(e))){for(var t of(e=Array.isArray(e)?[...e]:{...e},Object.keys(r)))e[t]=T(e[t],r[t]);return e}return r},q=(e,r,t)=>{var a=e.error?e.error.graphQLErrors:[],n=!!e.extensions||!!r.extensions,o={...e.extensions,...r.extensions},s=r.incremental;"path"in r&&(s=[r]);var f={data:e.data};if(s)for(var l of s){Array.isArray(l.errors)&&a.push(...l.errors),l.extensions&&(Object.assign(o,l.extensions),n=!0);for(var c="data",d=f,p=0,u=l.path.length;p<u;c=l.path[p++])d=d[c]=Array.isArray(d[c])?[...d[c]]:{...d[c]};if(l.items)for(var y=+c>=0?c:0,v=0,h=l.items.length;v<h;v++)d[y+v]=T(d[y+v],l.items[v]);else void 0!==l.data&&(d[c]=T(d[c],l.data))}else f.data=r.data||e.data,a=r.errors||a;return{operation:e.operation,data:f.data,error:a.length?new i({graphQLErrors:a,response:t}):void 0,extensions:n?o:void 0,hasNext:null!=r.hasNext?r.hasNext:e.hasNext,stale:!1}},L=(e,r,t)=>({operation:e,data:void 0,error:new i({networkError:r,response:t}),extensions:void 0,hasNext:!1,stale:!1});function I(e){return{query:e.extensions&&e.extensions.persistedQuery&&!e.extensions.persistedQuery.miss?void 0:O(e.query),operationName:j(e.query),variables:e.variables||void 0,extensions:e.extensions}}var Q=(e,r)=>{var t="query"===e.kind&&e.context.preferGetMethod;if(!t||!r)return e.context.url;var a=new URL(e.context.url);for(var n in r){var o=r[n];o&&a.searchParams.set(n,"object"==typeof o?u(o):o)}var s=a.toString();return s.length>2047&&"force"!==t?(e.context.preferGetMethod=!1,e.context.url):s},C=(e,r)=>{var t={accept:"subscription"===e.kind?"text/event-stream, multipart/mixed":"application/graphql-response+json, application/graphql+json, application/json, text/event-stream, multipart/mixed"},a=("function"==typeof e.context.fetchOptions?e.context.fetchOptions():e.context.fetchOptions)||{};if(a.headers)for(var n in a.headers)t[n.toLowerCase()]=a.headers[n];var o=((e,r)=>{var t,a;if(r&&("query"!==e.kind||!e.context.preferGetMethod)){var n=u(r),o=(t=r.variables,a=new Map,v===y&&h===y||(l.clear(),p(a,"variables",t)),a);if(o.size){var s=new FormData;s.append("operations",n),s.append("map",u({...[...o.keys()].map((e=>[e]))}));var i=0;for(var f of o.values())s.append(""+i++,f);return s}return n}})(e,r);return"string"!=typeof o||t["content-type"]||(t["content-type"]="application/json"),{...a,method:o?"POST":"GET",body:o,headers:t}},M="undefined"!=typeof TextDecoder?new TextDecoder:null,$=/boundary="?([^=";]+)"?/i,J=/data: ?([^\n]+)/,G=e=>"Buffer"===e.constructor.name?e.toString():M.decode(e);async function*D(e){if(e.body[Symbol.asyncIterator])for await(var r of e.body)yield G(r);else{var t,a=e.body.getReader();try{for(;!(t=await a.read()).done;)yield G(t.value)}finally{a.cancel()}}}async function*F(e,r){var t,a="";for await(var n of e)for(a+=n;(t=a.indexOf(r))>-1;)yield a.slice(0,t),a=a.slice(t+r.length)}function P(e,r,t){return n((e=>!!e))(o(async function*(e,r,t){var a,n,o=!0,s=null;try{"undefined"!=typeof AbortController&&(t.signal=(a=new AbortController).signal),yield await Promise.resolve();var i,f=(n=await(e.context.fetch||fetch)(r,t)).headers.get("Content-Type")||"";if(/multipart\/mixed/i.test(f))i=async function*(e,r){var t,a=e.match($),n="--"+(a?a[1]:"-"),o=!0;for await(var s of F(D(r),"\r\n"+n)){if(o){o=!1;var i=s.indexOf(n);if(!(i>-1))continue;s=s.slice(i+n.length)}try{yield t=JSON.parse(s.slice(s.indexOf("\r\n\r\n")+4))}catch(e){if(!t)throw e}if(t&&!t.hasNext)break}t&&t.hasNext&&(yield{hasNext:!1})}(f,n);else if(/text\/event-stream/i.test(f))i=async function*(e){var r;for await(var t of F(D(e),"\n\n")){var a=t.match(J);if(a){var n=a[1];try{yield r=JSON.parse(n)}catch(e){if(!r)throw e}if(r&&!r.hasNext)break}}r&&r.hasNext&&(yield{hasNext:!1})}(n);else{if(/text\//i.test(f))throw new Error(await n.text());i=async function*(e){yield JSON.parse(await e.text())}(n)}for await(var l of i)s=s?q(s,l,n):_(e,l,n),o=!1,yield s,o=!0;s||(yield s=_(e,{},n))}catch(r){if(!o)throw r;yield L(e,n&&(n.status<200||n.status>=300)&&n.statusText?new Error(n.statusText):r,n)}finally{a&&a.abort()}}(e,r,t)))}export{i as C,q as a,_ as b,L as c,Q as d,C as e,P as f,S as g,A as h,u as i,E as k,I as m,O as s};
//# sourceMappingURL=urql-core-chunk.min.mjs.map
